---
title: 怎么预防按钮的重复点击？
pubDatetime: 2022-07-23T16:00:00.000Z
author: caorushizi
tags:
  - javascript
postSlug: 00154633bf8ef6a38a1bdb6c2c12dbad
description: >-
  先看看在那些场景会导致重复请求：1.手速快，不小心双击操作按钮。2.很小心的点击了一次按钮，因为请求响应比较慢，页面没有任何提示，怀疑上次点击没生效，再次点击操作按钮。3.很小心的点击了一次按钮，因为
difficulty: 3
questionNumber: 93
source: >-
  https://fe.ecool.fun/topic-answer/77336d84-243e-49a0-b4b2-47bad83292e9?orderBy=updateTime&order=desc&tagId=10
---

先看看在那些场景会导致重复请求：

1.  手速快，不小心双击操作按钮。
2.  很小心的点击了一次按钮，因为请求响应比较慢，页面没有任何提示，怀疑上次点击没生效，再次点击操作按钮。
3.  很小心的点击了一次按钮，因为请求响应比较慢，页面没有任何提示，刷新页面，再次点击操作按钮。

## 前端方案

我们可以对症下药：

1.  控制按钮，在短时间内被多次点击，第一次以后的点击无效。
2.  控制按钮，在点击按钮触发的请求响应之前，再次点击无效。
3.  配置特殊的 URL，然后控制这些 URL 请求的最小时间间隔。如果再次请求跟前一次请求间隔很小，弹窗二次提示，是否继续操作。

### 防止无意识重复点击按钮

给按钮添加控制，在`control` 毫秒内，第一次点击事件之后的点击事件不执行。

```typescript
undefined;
```

当然时间间隔可以设置，默认为 300 毫秒。我们无意识的重复点击一般在 300 毫秒以内。

### 按钮点击立马禁用，等响应回来才能继续点击

触发点击的 button 实例传入 fetch 配置，代码如下：

```typescript
undefined;
```

在 fetch 函数内部，设置 button 的`disabled=true`，当响应回来时，设置`disabled=false`代码如下：

```typescript
undefined;
```

### 从根本入手，一招击杀

当页面刷新，页面状态重置，此时再次点击按钮，会判定为初次点击，而且按钮状态恢复可点击。我们可以设置哪些请求地址是重要的，它们请求间隔不能过小。如果过小，页面弹出覆层询问用户时候继续执行。

设置代码如下：

```typescript
undefined;
```

而实现代码如下：

```typescript
undefined;
```

攻击者可以绕过正常流程，模拟发起多次请求，所以仅仅在前端页面做好预防重复请求工作是不够的。后台接口需要设计得更健壮，具有幂等性。
